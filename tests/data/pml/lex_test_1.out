CONST          'const'
ID             'X'
ASSIGN         '='
NUM            '53' -- '53'
SEMICOLON      ';'
CONST          'const'
ID             'Y'
ASSIGN         '='
NUM            '4' -- '4'
TIMES          '*'
ID             'X'
SEMICOLON      ';'
VAR            'var'
ID             'Global'
SEMICOLON      ';'
VAR            'var'
ID             'another_global'
LBRACKET       '['
NUM            '40' -- '40'
RBRACKET       ']'
ASSIGN         '='
STRING         '"hello world"'
SEMICOLON      ';'
VAR            'var'
ID             'broadcast_var'
LBRACKET       '['
NUM            '4' -- '4'
RBRACKET       ']'
ASSIGN         '='
ID             'ip'
DOT            '.'
ID             'addr'
DOT            '.'
ID             'broadcast'
SEMICOLON      ';'
PPBEGIN        '?-'
ID             'ip'
DOT            '.'
ID             'saddr'
MATCH          '=~'
IPV4ADDR       '127.0.0.0' -- '127.0.0.0'
DIV            '/'
NUM            '24' -- '24'
PPEND          '-?'
LBRACE         '{'
PRINT          'print'
STRING         '"hi"'
COMMA          ','
ID             'x'
SEMICOLON      ';'
RBRACE         '}'
LBRACE         '{'
RBRACE         '}'
LBRACE         '{'
ID             'local'
ASSIGN         '='
NUM            '3' -- '3'
PLUS           '+'
NUM            '5' -- '5'
BOR            '|'
ID             'tcp'
LBRACKET       '['
NUM            '5' -- '5'
COMMA          ','
NUM            '2' -- '2'
RBRACKET       ']'
SEMICOLON      ';'
RBRACE         '}'
PPBEGIN        '?-'
ID             'ip'
PPEND          '-?'
LBRACE         '{'
ID             'a'
ASSIGN         '='
NUM            '0' -- '0'
SEMICOLON      ';'
ID             'i'
ASSIGN         '='
NUM            '0' -- '0'
SEMICOLON      ';'
ID             'csum'
ASSIGN         '='
NUM            '0' -- '0'
SEMICOLON      ';'
WHILE          'while'
LPAREN         '('
ID             'i'
LT             '<'
ID             'ip'
DOT            '.'
ID             'hlen'
RPAREN         ')'
LBRACE         '{'
ID             'csum'
ASSIGN         '='
ID             'csum'
PLUS           '+'
ID             'tcp'
LBRACKET       '['
ID             'i'
COMMA          ','
NUM            '2' -- '2'
RBRACKET       ']'
SEMICOLON      ';'
ID             'i'
ASSIGN         '='
ID             'i'
PLUS           '+'
NUM            '2' -- '2'
SEMICOLON      ';'
RBRACE         '}'
WHILE          'while'
LPAREN         '('
ID             'csum'
GT             '>'
NUM            '0xFFFF' -- '65535'
RPAREN         ')'
LBRACE         '{'
ID             'csum'
ASSIGN         '='
LPAREN         '('
ID             'csum'
AMP            '&'
NUM            '0xFFFF' -- '65535'
RPAREN         ')'
PLUS           '+'
LPAREN         '('
ID             'csum'
SHR            '>>'
NUM            '16' -- '16'
RPAREN         ')'
AMP            '&'
NUM            '0xFFFF' -- '65535'
SEMICOLON      ';'
RBRACE         '}'
IF             'if'
LPAREN         '('
LPAREN         '('
ID             'csum'
PLUS           '+'
ID             'ip'
LBRACKET       '['
NUM            '10' -- '10'
COMMA          ','
NUM            '2' -- '2'
RBRACKET       ']'
RPAREN         ')'
AMP            '&'
NUM            '0xFFFF' -- '65535'
NEQ            '!='
NUM            '0' -- '0'
RPAREN         ')'
LBRACE         '{'
PRINT          'print'
STRING         '"Bad checksum"'
SEMICOLON      ';'
RBRACE         '}'
ELSE           'else'
LBRACE         '{'
PRINT          'print'
STRING         '"Good checksum"'
SEMICOLON      ';'
RBRACE         '}'
ID             'ip'
DOT            '.'
ID             'daddr'
ASSIGN         '='
BYTESTR        '\x20304050'
SEMICOLON      ';'
ID             'a'
ASSIGN         '='
ID             'ip'
DOT            '.'
ID             'saddr'
MATCH          '=~'
ID             'ip'
DOT            '.'
ID             'addr'
DOT            '.'
ID             'localhost'
SEMICOLON      ';'
ID             'a'
ASSIGN         '='
ID             'ip'
DOT            '.'
ID             'saddr'
MATCH          '=~'
ID             'ip'
DOT            '.'
ID             'addr'
DOT            '.'
ID             'localnet'
SEMICOLON      ';'
RBRACE         '}'
End of file
